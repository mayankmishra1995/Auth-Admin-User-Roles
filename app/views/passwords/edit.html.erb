<%= form_for @user, url: password_path(@user), method: :patch do |f| %>
  <%= f.hidden_field :reset_password_token %>

  <div class="form-group">
    <%= f.label :password %>
    <%= f.password_field :password, class: "form-control", data: { controller: "password-strength" } %>
    <span class="form-text text-muted password-strength-message"></span>
  </div>

  <div class="form-group">
    <%= f.label :password_confirmation %>
    <%= f.password_field :password_confirmation, class: "form-control" %>
  </div>

  <div class="form-group">
    <%= f.submit "Reset Password", class: "btn btn-primary" %>
  </div>
<% end %>



#copied this javascript portion

#Added the live password strength validator using stimulus js


<script>
  import { Controller } from "stimulus"

  export default class extends Controller {
    connect() {
      this.passwordInput = this.element.querySelector('[type="password"]')
      this.messageElement = this.element.querySelector('.password-strength-message')
    }

    checkPasswordStrength() {
      const password = this.passwordInput.value

      if (password.length < 8) {
        this.messageElement.textContent = "Password must be at least 8 characters long."
      } else if (!/\d/.test(password)) {
        this.messageElement.textContent = "Password must contain at least one digit."
      } else if (!/[a-z]/.test(password)) {
        this.messageElement.textContent = "Password must contain at least one lowercase letter."
      } else if (!/[A-Z]/.test(password)) {
        this.messageElement.textContent = "Password must contain at least one uppercase letter."
      } else {
        this.messageElement.textContent = "Password is strong."
      }
    }

    onInput() {
      this.checkPasswordStrength()
    }
  }
</script>
